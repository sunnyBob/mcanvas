{"version":3,"file":"example.js","sources":["../../lib/utils.js","../../lib/mcanvas.js","../index.js"],"sourcesContent":["export default {\n    extend(obj1, obj2) {\n        let type = this.isType(obj2)\n        if(type === 'object'){\n            this.forin(obj2, (k, v) => {\n                let vType = this.isType(v)\n                if (vType !== 'object' && vType !== 'array') {\n                    obj1[k] = v\n                } else {\n                    if (this.isType(obj1[k]) !== vType || obj1[k] === null) {\n                        obj1[k] = vType === 'object' ? {} : []\n                    }\n                    this.extend(obj1[k], v)\n                }\n            })\n        }else if(type === 'array'){\n            for (let i = 0; i < obj2.length; i++) {\n                obj1[i] = obj2[i]\n            }\n        }else{\n            obj1 = obj2\n        }\n        return obj1\n    },\n    loadImage(image, loaded, error) {\n        let img = new Image()\n        if(image.indexOf('http') === 0){\n            img.crossOrigin = '*'\n        }\n        img.onload = () => {\n            loaded(img)\n            setTimeout(() => img = null, 1000)\n        }\n        img.onerror = () => {\n            error('img load error')\n        }\n        img.src = image\n    },\n    isObject(tar){\n        return this.isObjFunc(tar, 'Object')\n    },\n    isBoolean(tar){\n        return this.isObjFunc(tar, 'Boolean')\n    },\n    isArr(tar){\n        return this.isObjFunc(tar, 'Array')\n    },\n    getImage(image, cbk, error){\n        if(typeof image === 'string'){\n            this.loadImage(image, img => {\n                cbk(img)\n            }, error)\n        }else if(typeof image === 'object'){\n            cbk(image)\n        }else{\n            console.log('add image error')\n            return\n        }\n    },\n    forin(obj, cbk){\n        for(let k in obj){\n            if(obj.hasOwnProperty(k)){\n                cbk(k, obj[k])\n            }\n        }\n    },\n    isIos8(){\n        let UA = window.navigator.userAgent.toLowerCase()\n        let IOS = /(iPhone|iPad|iPod|iOS)/gi.test(UA)\n        let IPAD = /(iPad)/gi.test(UA)\n        if(IOS){\n            return IPAD ? UA.match(/cpu os (\\d*)/)[1] < 9 : UA.match(/iphone os (\\d*)/)[1] < 9\n        }else{\n            return false\n        }\n    },\n    deepCopy(obj){\n        return JSON.parse(JSON.stringify(obj))\n    },\n    isObjFunc(tar, name) {\n        return Object.prototype.toString.call(tar) === '[object ' + name + ']'\n    },\n    isType(tar){\n        return Object.prototype.toString.call(tar).split(' ')[1].replace(']', '').toLowerCase()\n    },\n    getSize(img){\n        let iw, ih\n        if(img.tagName === 'IMG'){\n            iw = img.naturalWidth\n            ih = img.naturalHeight\n        }else if(img.tagName === 'CANVAS'){\n            iw = img.width\n            ih = img.height\n        }else{\n            iw = img.offsetWidth\n            ih = img.offsetHeight\n        }\n        return { iw, ih }\n    },\n}\n","import _ from './utils'\n\nexport default function MCanvas(options = {}){\n    // 兼容不使用 new 的方式；\n    if (!(this instanceof MCanvas))return new MCanvas(options)\n\n    // 配置canvas初始大小；\n    // width：画布宽度，Number,选填，默认为 500;\n    // height: 画布高度，Number，选填，默认与宽度一致；\n    this.ops = _.extend({\n        width: 500,\n        height: 500,\n        backgroundColor : '',\n    }, options)\n\n    // 全局画布；\n    this.canvas = null\n    this.ctx = null\n    // 绘制函数队列；\n    this.queue = []\n    // 回调函数池；\n    this.fn = {\n        // 最后执行的函数；\n        success(){},\n        // 错误回调；\n        error(){},\n    }\n    this.data = {\n        // 文字id；\n        textId: 0,\n        // 文字绘制数据；\n        text : {},\n        // 背景图数据;\n        bgConfig : null,\n    }\n\n    // 初始化创建画布；\n    this._init()\n}\n\nMCanvas.prototype._init = function(){\n    this.canvas = document.createElement('canvas')\n    this.canvas.width = this.ops.width\n    this.canvas.height = this.ops.height\n    this.ctx = this.canvas.getContext('2d')\n\n    this.ops.backgroundColor && this.setBgColor(this.ops.backgroundColor)\n}\n\n// --------------------------------------------------------\n// 绘制背景部分；\n// --------------------------------------------------------\n\nMCanvas.prototype.background = function(image, bg = {\n    type : 'origin',\n}){\n    if(!image && !this.data.bgConfig){\n        console.error('mcanvas error : the init background must has a image.')\n        return\n    }\n\n    // 缓存bg options， 用于重置；\n    if(!image){\n        bg = this.data.bgConfig\n    }else{\n        bg.image = image\n        this.data.bgConfig = bg\n    }\n\n    this.queue.push(() => {\n        if(bg.color)this.setBgColor(bg.color)\n        _.getImage(bg.image, img =>{\n            this._background(img, bg)\n        }, this.fn.error)\n    })\n    return this\n}\n\n// 设置画布颜色;\nMCanvas.prototype.setBgColor = function(color){\n    this.ctx.fillStyle = color\n    this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height)\n}\n\nMCanvas.prototype._getBgAlign = function(left, iw, cw, cropScale){\n    let rv\n    if(typeof left === 'string'){\n        if(left === '50%' || left === 'center'){\n            rv = Math.abs((iw - cw / cropScale) / 2)\n        }else if(left === '100%'){\n            rv = Math.abs(iw - cw / cropScale)\n        }else if(left === '0%'){\n            rv = 0\n        }\n    }else if(typeof left === 'number'){\n        rv = left\n    }else{\n        rv = 0\n    }\n    return rv\n}\nMCanvas.prototype._background = function(img, bg){\n    let { iw, ih } = _.getSize(img)\n    // 图片与canvas的长宽比；\n    let iRatio = iw / ih\n    let cRatio = this.canvas.width / this.canvas.height\n    // 背景绘制参数；\n    let sx, sy, swidth, sheight, dx, dy, dwidth, dheight\n    let cropScale\n    switch (bg.type) {\n        // 裁剪模式，固定canvas大小，原图铺满，超出的部分裁剪；\n        case 'crop':\n            if(iRatio > cRatio){\n                swidth = ih * cRatio\n                sheight = ih\n                cropScale = this.canvas.height / ih\n            }else{\n                swidth = iw\n                sheight = swidth / cRatio\n                cropScale = this.canvas.width / iw\n            }\n\n            sx = this._getBgAlign(bg.left, iw, this.canvas.width, cropScale)\n            sy = this._getBgAlign(bg.top, ih, this.canvas.height, cropScale)\n\n            dy = dx = 0\n            dheight = this.canvas.height\n            dwidth = this.canvas.width\n            break\n        // 包含模式，固定canvas大小，包含背景图；\n        case 'contain':\n            sy = sx = 0\n            swidth = iw\n            sheight = ih\n            if(iRatio > cRatio){\n                dwidth = this.canvas.width\n                dheight = dwidth / iRatio\n                dx = bg.left || 0\n                dy = (bg.top || bg.top === 0) ? bg.top : (this.canvas.height - dheight) / 2\n            }else{\n                dheight = this.canvas.height\n                dwidth = dheight * iRatio\n                dy = bg.top || 0\n                dx = (bg.left || bg.left === 0) ? bg.left : (this.canvas.width - dwidth) / 2\n            }\n            break\n        // 原图模式：canvas与原图大小一致，忽略初始化 传入的宽高参数；\n        // 同时，background 传入的 left/top 均被忽略；\n        case 'origin':\n            this.canvas.width = iw\n            this.canvas.height = ih\n            sx = sy = 0\n            swidth = iw\n            sheight = ih\n            dx = dy = 0\n            dwidth = this.canvas.width\n            dheight = this.canvas.height\n            break\n        default:\n            console.error('mcanvas error:background type error!')\n            return\n    }\n    this.ctx.drawImage(img, sx, sy, swidth, sheight, dx, dy, dwidth, dheight)\n    this._next()\n}\n// --------------------------------------------------------\n// 绘制图层部分；\n// --------------------------------------------------------\n\n// 绘制矩形层；\nMCanvas.prototype.rect = function(ops){\n    this.queue.push(() => {\n        let { fillColor = '#fff', strokeColor = fillColor, strokeWidth = 0 } = ops\n        let cw = this.canvas.width, ch = this.canvas.height\n        let width = this._get(cw, 0, ops.width || 0, 'pos') - 2 * strokeWidth,\n            height = this._get(ch, 0, ops.height || 0, 'pos') - 2 * strokeWidth\n        let x = this._get(cw, width, ops.x || 0, 'pos') + strokeWidth / 2,\n            y = this._get(ch, height, ops.y || 0, 'pos') + strokeWidth / 2\n        this.ctx.lineWidth = strokeWidth\n        this.ctx.fillStyle = fillColor\n        this.ctx.strokeStyle = strokeColor\n\n        this.ctx.beginPath()\n        this.ctx.strokeRect(x, y, width, height)\n        this.ctx.fillRect(x, y, width, height)\n        this.ctx.closePath()\n\n        this._resetCtx()._next()\n    })\n    return this\n}\n\n// 绘制圆形层；\nMCanvas.prototype.circle = function(ops){\n    this.queue.push(() => {\n        let { fillColor = '#fff', strokeColor = fillColor, strokeWidth = 0 } = ops\n        let cw = this.canvas.width, ch = this.canvas.height\n        let r = this._get(cw, 0, ops.r || 0, 'pos') - 2 * strokeWidth\n        let x = this._get(cw, 2 * r, ops.x || 0, 'pos') + strokeWidth / 2 + r,\n            y = this._get(ch, 2 * r, ops.y || 0, 'pos') + strokeWidth / 2 + r\n\n        this.ctx.beginPath()\n        this.ctx.arc(x, y, r, 0, Math.PI * 2, false)\n        this.ctx.fillStyle = fillColor\n        this.ctx.fill()\n        this.ctx.strokeStyle = strokeColor\n        this.ctx.lineWidth = strokeWidth\n        this.ctx.stroke()\n        this.ctx.closePath()\n\n        this._resetCtx()._next()\n    })\n    return this\n}\n\n// 重置ctx属性;\nMCanvas.prototype._resetCtx = function(){\n    this.ctx.setTransform(1, 0, 0, 1, 0, 0)\n    return this\n}\n\n// 绘制水印；基于 add 函数封装；\nMCanvas.prototype.watermark = function(image = '', ops){\n    if(!image){\n        console.error('mcanvas error : there is not image of watermark.')\n        return\n    }\n    // 参数默认值；\n    let { width = '40%', pos = 'rightbottom', margin = 20 } = ops\n    let position = {\n        x:0,\n        y:0,\n        scale:1,\n        rotate:0,\n    }\n    switch (pos) {\n        case 'leftTop':\n            position.x = `left:${margin}`\n            position.y = `top:${margin}`\n            break\n        case 'leftBottom':\n            position.x = `left:${margin}`\n            position.y = `bottom:${margin}`\n            break\n        case 'rightTop':\n            position.x = `right:${margin}`\n            position.y = `top:${margin}`\n            break\n        case 'rightBottom':\n            position.x = `right:${margin}`\n            position.y = `bottom:${margin}`\n            break\n        default:\n    }\n    this.add(image, {\n        width,\n        pos:position,\n    })\n    return this\n}\n\n// 通用绘制图层函数；\n// 使用方式：\n// 多张图: add([{image:'',options:{}},{image:'',options:{}}]);\n// 单张图: add(image,options);\nMCanvas.prototype.add = function(image = '', options){\n    // 默认参数；\n    let def = {\n        width:'100%',\n        crop:{\n            x:0,\n            y:0,\n            width:'100%',\n            height:'100%',\n        },\n        pos:{\n            x:0,\n            y:0,\n            scale:1,\n            rotate:0,\n        },\n    }\n\n    if(!_.isArr(image))image = [{image, options}]\n\n    image.forEach( v =>{\n        // 将封装好的 add函数 推入队列中待执行；\n        // 参数经过 _handleOps 加工；\n        this.queue.push(() => {\n            _.getImage(v.image, img => {\n                this._add(img, this._handleOps(_.extend(def, v.options), img))\n            }, this.fn.error)\n        })\n    })\n\n    return this\n}\n\nMCanvas.prototype._add = function(img, ops){\n    if(ops.width === 0)console.warn(`mcanvas warn: the width of mc-element is zero`)\n    let { iw, ih } = _.getSize(img)\n    // let ratio = iw / ih;\n    // 画布canvas参数；\n    let cdx, cdy, cdw, cdh\n    // 素材canvas参数；\n    let { x: lsx, y: lsy, width: lsw, height: lsh } = ops.crop\n\n    let cratio = lsw / lsh\n    let ldx, ldy, ldw, ldh\n    // 素材canvas的绘制;\n    let lcvs = document.createElement('canvas')\n    let lctx = lcvs.getContext('2d')\n    // 图片宽高比 * 1.4 是一个最安全的宽度，旋转任意角度都不会被裁剪；\n    // 没有旋转却长宽比很高大的图，会导致放大倍数太大，因此甚至了最高倍数为5；\n    // _ratio 为 较大边 / 较小边 的比例；\n    let _ratio = iw > ih ? iw / ih : ih / iw\n    let lctxScale = _ratio * 1.4 > 5 ? 5 : _ratio * 1.4\n    let spaceX, spaceY\n\n    lcvs.width =  Math.round(lsw * lctxScale)\n    lcvs.height = Math.round(lsh * lctxScale)\n\n    // 限制canvas的大小，ios8以下为 2096, 其余平台均限制为 4096;\n    let shrink\n    if(_.isIos8() && (lcvs.width > 2096 || lcvs.height > 2096)){\n        if(cratio > 1){\n            shrink = 2096 / lcvs.width\n        }else{\n            shrink = 2096 / lcvs.height\n        }\n    }else if(lcvs.width > 4096 || lcvs.height > 4096){\n        if(cratio > 1){\n            shrink = 4096 / lcvs.width\n        }else{\n            shrink = 4096 / lcvs.height\n        }\n    }\n\n    // 从素材canvas的中心点开始绘制；\n    ldx = - Math.round(lsw / 2)\n    ldy = - Math.round(lsh / 2)\n    ldw = lsw\n    ldh = Math.round(lsw / cratio)\n\n    // 获取素材最终的宽高;\n    if(shrink){\n        [lcvs.width, lcvs.height, ldx, ldy, ldw, ldh] = [lcvs.width, lcvs.height, ldx, ldy, ldw, ldh].map(v => Math.round(v * shrink))\n    }\n\n    lctx.translate(lcvs.width / 2, lcvs.height / 2)\n    lctx.rotate(ops.pos.rotate)\n\n    lctx.drawImage(img, lsx, lsy, lsw, lsh, ldx, ldy, ldw, ldh)\n\n    cdw = Math.round(ops.width * lctxScale)\n    cdh = Math.round(cdw / cratio)\n\n    spaceX = (lctxScale - 1) * ops.width / 2\n    spaceY = spaceX / cratio\n\n    // 获取素材的位置；\n    //    配置的位置 - 缩放的影响 - 绘制成正方形的影响；\n    cdx = Math.round(ops.pos.x + cdw * ( 1 - ops.pos.scale ) / 2 - spaceX)\n    cdy = Math.round(ops.pos.y + cdh * ( 1 - ops.pos.scale ) / 2 - spaceY)\n\n    cdw *= ops.pos.scale\n    cdh *= ops.pos.scale\n\n    this.ctx.drawImage(lcvs, cdx, cdy, cdw, cdh)\n\n    lcvs = lctx = null\n    this._next()\n}\n\n// 参数加工函数；\nMCanvas.prototype._handleOps = function(ops, img){\n    let cw = this.canvas.width,\n        ch = this.canvas.height\n    let { iw, ih } = _.getSize(img)\n\n    // 图片宽高比；\n    let ratio = iw / ih\n\n    // 根据参数计算后的绘制宽度；\n    let width =  this._get(cw, iw, ops.width, 'pos')\n\n    // 裁剪的最大宽高；\n    let maxLsw, maxLsh\n\n    // 裁剪参数；\n    let { x:cropx, y:cropy, width:cropw, height:croph } = ops.crop\n    let crop = {}\n    crop.width = this._get(cw, iw, cropw, 'crop')\n    crop.height = this._get(ch, ih, croph, 'crop')\n    crop.x = this._get(iw, crop.width, cropx, 'crop')\n    crop.y = this._get(ih, crop.height, cropy, 'crop')\n\n    // 最大值判定；\n    if(crop.x > iw)crop.x = iw\n    if(crop.y > ih)crop.y = ih\n    maxLsw = iw - crop.x\n    maxLsh = ih - crop.y\n    if(crop.width > maxLsw)crop.width = maxLsw\n    if(crop.height > maxLsh)crop.height = maxLsh\n\n    // 位置参数；\n    let { x: px, y: py, rotate: pr, scale: ps } = ops.pos\n    let pos = {\n        x:this._get(cw, width, px, 'pos'),\n        y:this._get(ch, width / ratio, py, 'pos'),\n        scale : ps,\n        rotate : parseFloat(pr) * Math.PI / 180,\n    }\n    return {width, crop, pos}\n}\n\n// --------------------------------------------------------\n// 绘制文字部分；\n// --------------------------------------------------------\nMCanvas.prototype.text = function(context = '', ops){\n    // 默认字体；\n    let fontFamily = `helvetica neue,hiragino sans gb,Microsoft YaHei,arial,tahoma,sans-serif`\n    // 默认的字体大小;\n    let size = this.canvas.width / 20\n\n    this.queue.push(()=>{\n        let defaultStyle = {\n            color:'#000',\n            type : 'fill',   // strokeText or fillText,\n            lineWidth : 1,\n            shadow:{\n                color: null,\n                blur: 0,\n                offsetX: 0,\n                offsetY: 0,\n            },\n        }\n        let option = {\n            width : 300,\n            align : 'left',\n            smallStyle:{\n                font : `${size * 0.8}px ${fontFamily}`,\n                lineHeight:size * 0.9,\n                ..._.deepCopy(defaultStyle),\n            },\n            normalStyle:{\n                font : `${size}px ${fontFamily}`,\n                lineHeight:size * 1.1,\n                type : 'fill',   // strokeText or fillText,\n                ..._.deepCopy(defaultStyle),\n            },\n            largeStyle:{\n                font : `${size * 1.3}px ${fontFamily}`,\n                lineHeight:size * 1.4,\n                ..._.deepCopy(defaultStyle),\n            },\n            pos:{\n                x:0,\n                y:0,\n                rotate: 0,\n            },\n        }\n\n        option = _.extend(option, ops)\n\n        // 解析字符串模板后，调用字体绘制函数；\n        let parseContext = this._parse(context)\n        let max = 0, maxFont\n        parseContext.map(v => {\n            if (v.size > max) {\n                max = v.size\n                maxFont = v.type\n            }\n        })\n        // 当设置的宽度小于字体宽度时，强行将设置宽度设为与字体一致；\n        let maxFontSize = parseInt(option[`${maxFont}Style`].font)\n        if (maxFontSize && option.width < maxFontSize) option.width = maxFontSize\n\n        this._text(parseContext, option)\n        this._resetCtx()._next()\n    })\n    return this\n}\n// 字符串模板解析函数\n// 解析 <s></s> <b></b>\nMCanvas.prototype._parse = function(context){\n    let arr = context.split(/<s>|<b>/)\n    let result = []\n    for(let i = 0;i < arr.length;i++){\n        let value = arr[i]\n        if(/<\\/s>|<\\/b>/.test(value)){\n            let splitTag = /<\\/s>/.test(value) ? '</s>' : '</b>',\n                type     = /<\\/s>/.test(value) ? 'small' : 'large'\n            let tmp = arr[i].split(splitTag)\n            result.push({\n                type,\n                text:tmp[0],\n                // 用于字体的大小比较；\n                size: type === 'small' ? 0 : 2,\n            })\n            tmp[1] && result.push({\n                type:'normal',\n                text:tmp[1],\n                size: 1,\n            })\n            continue\n        }\n        arr[i] && result.push({\n            text:arr[i],\n            type:'normal',\n            size: 1,\n        })\n    }\n    return result\n}\n\nMCanvas.prototype._text = function(textArr, option){\n\n    this.data.textId++\n    this.data.text[this.data.textId] = {}\n\n    // 处理宽度参数；\n    option.width = this._get(this.canvas.width, 0, option.width, 'pos')\n\n    let style, line = 1, length = 0,\n        lineHeight = getLineHeight(textArr, option),\n        x = this._get(this.canvas.width, option.width, 0, 'pos'),\n        y = (this._get(this.canvas.height, 0, 0, 'pos')) + lineHeight\n\n    // data:字体数据；\n    // lineWidth:行宽；\n    this.data.text[this.data.textId][line] = {\n        data:[],\n        lineWidth:0,\n    }\n\n    // 生成字体数据；\n    textArr.forEach(v =>{\n        style = option[`${v.type}Style`]\n        this.ctx.font = style.font\n        let width = this.ctx.measureText(v.text).width\n\n        // 处理 <br> 换行，先替换成 '|',便于单字绘图时进行判断；\n        let context = v.text.replace(/<br>/g, '|')\n\n        // 先进行多字超出判断，超出宽度后再进行单字超出判断；\n        if((length + width) > option.width || context.indexOf('|') !== -1){\n            for (let i = 0, fontLength = context.length; i < fontLength; i++) {\n                let font = context[i]\n                width = this.ctx.measureText(font).width\n\n                // 当字体的计算宽度 > 设置的宽度 || 内容中包含换行时,进入换行逻辑；\n                if((length + width) > option.width || font === '|'){\n                    length = 0\n                    x = this._get(this.canvas.width, option.width, 0, 'pos')\n                    y += lineHeight\n                    line += 1\n                    this.data.text[this.data.textId][line] = {\n                        data:[],\n                        lineWidth:0,\n                    }\n                    if(font === '|')continue\n                }\n                this.data.text[this.data.textId][line]['data'].push({\n                    context:font, x, y, style, width,\n                })\n                length += width\n                x += width\n                this.data.text[this.data.textId][line]['lineWidth'] = length\n            }\n        }else{\n            this.data.text[this.data.textId][line]['data'].push({\n                context, x, y, style, width,\n            })\n            length += width\n            x += width\n            this.data.text[this.data.textId][line]['lineWidth'] = length\n        }\n    })\n\n    // 创建文字画布；\n    const tcvs = document.createElement('canvas')\n    const tctx = tcvs.getContext('2d')\n    const tdx = this._get(this.canvas.width, option.width, option.pos.x, 'pos'),\n          tdy = this._get(this.canvas.height, 0, option.pos.y, 'pos')\n    let tdw, tdh\n    tdw = tcvs.width = option.width\n    tdh = tcvs.height = this._getTextRectHeight(line)\n\n    // 通过字体数据进行文字的绘制；\n    _.forin(this.data.text[this.data.textId], (k, v)=>{\n        // \b增加 align 的功能；\n        let add = 0\n        if(v.lineWidth < option.width){\n            if(option.align === 'center'){\n                add = (option.width - v.lineWidth) / 2\n            }else if (option.align === 'right') {\n                add = option.width - v.lineWidth\n            }\n        }\n        v.data.forEach(text=>{\n            text.x += add\n            this._fillText(tctx, text)\n        })\n    })\n\n    // tcvs.style.width = '300px';\n    // document.querySelector('body').appendChild(tcvs);\n\n    // 绘制文字画布；\n    const originX = tdx + tdw / 2,\n          originY = tdy + tdh / 2\n    this.ctx.translate(originX, originY)\n    this.ctx.rotate(parseFloat(option.pos.rotate) * Math.PI / 180)\n    this.ctx.drawImage(tcvs, -tdw / 2, -tdh / 2, tdw, tdh)\n\n    // 获取行高；\n    function getLineHeight(textArr, option) {\n        let lh = 0, vlh\n        textArr.forEach( v =>{\n            vlh = option[`${v.type}Style`].lineHeight\n            if(vlh > lh)lh = vlh\n        })\n        return lh\n    }\n}\n\nMCanvas.prototype._fillText = function(ctx, text){\n    let {context, x, y, style} = text\n    let {align, lineWidth, shadow} = style\n    let {color, blur, offsetX, offsetY} = shadow\n    ctx.font = style.font\n    ctx.textAlign = align\n    ctx.textBaseline = 'alphabetic'\n    ctx.lineWidth = lineWidth\n    ctx.shadowColor = color\n    ctx.shadowBlur = blur\n    ctx.shadowOffsetX = offsetX\n    ctx.shadowOffsetY = offsetY\n\n    if(style.gradient){\n        let { type, colorStop } = style.gradient\n        let x1, y1, x2, y2\n        if(type === 1){\n            x1 = x; y1 = y\n            x2 = x + text.width; y2 = y\n        }else{\n            x1 = x; y1 = y - style.lineHeight\n            x2 = x; y2 = y\n        }\n        let grad  = ctx.createLinearGradient(x1, y1, x2, y2)\n        let colorNum = colorStop.length || 0\n        _.forin(colorStop, (i, v)=>{\n            grad.addColorStop(1 / colorNum * (+i + 1), v)\n        })\n        ctx[`${style.type}Style`] = grad\n    }else{\n        ctx[`${style.type}Style`] = style.color\n    }\n\n    ctx[`${style.type}Text`](context, x, y)\n    this._resetCtx()\n}\n\nMCanvas.prototype._getTextRectHeight = function (lastLine) {\n    const lastLineData = this.data.text[this.data.textId][lastLine].data[0]\n    return lastLineData.y + lastLineData.style.lineHeight\n}\n\n// --------------------------------------------------------\n// 业务功能函数部分\n// --------------------------------------------------------\n\n// 参数加工函数；\n// 兼容 5 种 value 值：\n// x:250, x:'250px', x:'100%', x:'left:250',x:'center',\n// width:100,width:'100px',width:'100%'\nMCanvas.prototype._get = function(par, child, str, type){\n    let result = str\n    if(typeof str === 'string'){\n        if(str.indexOf(':') !== -1 && type === 'pos'){\n            let arr = str.split(':')\n            switch (arr[0]) {\n                case 'left':\n                case 'top':\n                    result = +(arr[1].replace('px', ''))\n                    break\n                case 'right':\n                case 'bottom':\n                    result = par - (+(arr[1].replace('px', ''))) - child\n                    break\n                default:\n            }\n        } else if (str.indexOf('px') !== -1) {\n            result = (+str.replace('px', ''))\n        } else if (str.indexOf('%') !== -1) {\n            if(type === 'crop'){\n                result = child * (+str.replace('%', '')) / 100\n            }else{\n                result = par * (+str.replace('%', '')) / 100\n            }\n        } else if (str === 'center'){\n            result = (par - child) / 2\n        } else if (str === 'origin') {\n            result = child\n        } else {\n            result = +str\n        }\n    }\n    return Math.round(result)\n}\n\n// 绘制函数；\nMCanvas.prototype.draw = function(ops){\n    let _ops = {\n        type:'jpeg',\n        quality:.9,\n        success(){},\n        error(){},\n    }, b64\n    if(typeof ops === 'function'){\n        _ops.success = ops\n    }else{\n        _ops = _.extend(_ops, ops)\n        if(_ops.type === 'jpg')_ops.type = 'jpeg'\n    }\n    this.fn.error = _ops.error\n    this.fn.success = () => {\n        setTimeout(()=>{\n            b64 = this.canvas.toDataURL(`image/${_ops.type}`, _ops.quality)\n            _ops.success(b64)\n        }, 0)\n    }\n    this._next()\n    return this\n}\n\nMCanvas.prototype._next = function(){\n    if(this.queue.length > 0){\n        this.ctx.save();\n        this.queue.shift()()\n        this.ctx.restore();\n    }else{\n        this.fn.success()\n    }\n}\n\nMCanvas.prototype.clear = function(){\n    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height)\n    return this\n}","import MCanvas from '../lib/index'\n// import { MCrop } from '../lib/index'\n\n// MCrop('http://mtapplet.meitudata.com/596c72073971d86b5128.jpg', {\n//     type: 'rect',\n//     x: 'center',\n//     y: 100,\n//     width: 300,\n//     height: 300,\n//     success(b64) {\n//         document.querySelector('#img111').src = b64\n//     },\n// })\n// MCrop('http://mtapplet.meitudata.com/596c72073971d86b5128.jpg', {\n//     type: 'circle',\n//     x: 'center',\n//     y: '0',\n//     r: 200,\n//     success(b64) {\n//         document.querySelector('#img111').src = b64\n//     },\n// })\n\nlet $sure = $('.js-sure')\nlet $params = $('.js-params')\nlet $dialog = $('.js-dialog')\nlet $result = $('.js-result')\nlet $cancel = $('.js-cancel')\nlet $clear = $('.js-clear')\n\nlet data = {\n    addImageOps : {\n        image:'./images/ear.png',\n        // image:'https://mtapplet.meitudata.com/59c8c479521876738.jpg',\n        options:{\n            width:482,\n            pos:{\n                x:150,\n                y:58,\n                scale:1,\n                rotate:1,\n            },\n        },\n    },\n    addWmOps : {\n        image:'images/watermark.jpg',\n        options:{\n            width:'40%',\n            pos:'rightBottom',\n        },\n    },\n    addRectOps:{\n        x: 0,\n        y: 'bottom:0',\n        width: '100%',\n        height: 300,\n        strokeWidth : 5,\n        strokeColor: '#996699',\n        fillColor: 'rgba(0,0,0,.5)',\n    },\n    addCircleOps:{\n        x: 'center',\n        y: 'center',\n        r: 100,\n        strokeWidth : 5,\n        strokeColor: '#996699',\n        fillColor: 'rgba(0,0,0,.5)',\n    },\n    addTextOps : {\n        // text:'<b>A</b>BBBBB<s>MCanvas.js</s>',\n        text:'<b>Large/Stroke</b><br>Normal/Gradient<br><s>Small/Shadow</s>',\n        options:{\n            width:'600',\n            align:'center',\n            largeStyle:{\n                color:'red',\n                font: '90px Microsoft YaHei,sans-serif',\n                type: 'stroke',\n                lineWidth: 2,\n                lineHeight : 90,\n            },\n            normalStyle:{\n                color:'blue',\n                font:'70px Microsoft YaHei,sans-serif',\n                lineHeight : 70,\n                // shadow:{\n                //     color: 'red',\n                //     blur: 4,\n                //     offsetX: 2,\n                //     offsetY: 2,\n                // },\n                gradient:{\n                    type: 2,  // 1: 横向渐变； 2: 纵向渐变；\n                    colorStop: ['red', 'blue'],\n                },\n            },\n            smallStyle:{\n                color:'yellow',\n                font:'50px Microsoft YaHei,sans-serif',\n                lineHeight : 50,\n                shadow:{\n                    color: 'red',\n                    blur: 10,\n                    offsetX: 5,\n                    offsetY: 5,\n                },\n            },\n            pos:{\n                x:'center',\n                y:'bottom:400',\n                rotate: 0,\n            },\n        },\n    },\n}\nlet mc = new MCanvas({\n    width: 1000,\n    height: 1500,\n    // backgroundColor: 'black',\n})\nmc.background('http://mtapplet.meitudata.com/596c72073971d86b5128.jpg', {\n// mc.background('http://mtapplet.meitudata.com/59e8765b6492c541.jpg',{\n    type:'origin',\n    left:'50%',\n    top:'50%',\n})\n\nlet timer\n$('.Button').on('touchstart', function(){\n    $(this).addClass('taped')\n    timer = setTimeout(()=>{\n        $(this).removeClass('taped')\n    }, 2000)\n})\n$('.Button').on('touchend', function(){\n    $(this).removeClass('taped')\n    clearTimeout(timer)\n})\n\n$cancel.on('click', ()=>{\n    $dialog.hide()\n})\n\n$clear.on('click', ()=>{\n    // mc.clear();\n    mc.background().clear().draw(b64=>{\n        $result.attr('src', b64)\n    })\n})\n\n$('.js-addImage').on('click', ()=>{\n    let type = `image`\n    showDialog(type, data.addImageOps)\n})\n\n$('.js-addWm').on('click', ()=>{\n    let type = `watermark`\n    showDialog(type, data.addWmOps)\n})\n\n$('.js-addText').on('click', ()=>{\n    let type = `text`\n    showDialog(type, data.addTextOps)\n})\n\n$('.js-addRect').on('click', ()=>{\n    mcDraw(data.addRectOps, 'rect')\n})\n\n$('.js-addCircle').on('click', ()=>{\n    mcDraw(data.addCircleOps, 'circle')\n})\n\n$sure.on('click', function(){\n    let ops = $(this).data('ops')\n    let type = $(this).data('type')\n    mcDraw(ops, type)\n})\n\nfunction mcDraw(ops, type){\n    let img\n    switch (type) {\n        case `image`:\n            img = new Image()\n            img.crossOrigin = '*'\n            img.onload = function(){\n                mc.add(img, ops.options).draw({\n                    type:'jpg',\n                    quality:.9,\n                    success(b64){\n                        $result.attr('src', b64)\n                        $dialog.hide()\n                    },\n                    error(err){\n                        console.log('error', err)\n                    },\n                })\n            }\n            img.src = ops.image\n            break\n        case `watermark`:\n            mc.watermark(ops.image, ops.options).draw(b64=>{\n                $result.attr('src', b64)\n                $dialog.hide()\n            })\n            break\n        case `text`:\n            mc.text(ops.text, ops.options).draw(b64=>{\n                $result.attr('src', b64)\n                $dialog.hide()\n            })\n            break\n        case `rect`:\n            mc.rect(ops).draw(b64=>{\n                $result.attr('src', b64)\n                $dialog.hide()\n            })\n            break\n        case `circle`:\n            mc.circle(ops).draw(b64=>{\n                $result.attr('src', b64)\n                $dialog.hide()\n            })\n            break\n        default:\n    }\n\n}\n\nfunction showDialog(type, ops){\n    let tab = `&nbsp;&nbsp;&nbsp;&nbsp;`\n    let html\n    switch (type) {\n        case 'image':\n            html = `<li>image:'${ops.image}'</li>\n                    <li>options:{</li>\n                    <li>${tab}width:<input data-type='width' class='js-input input' type='text' value='${ops.options.width}'></li>\n                    <li>${tab}pos:{</li>\n                    <li>${tab + tab}x:<input data-type='x' class='js-input input' type='text' value='${ops.options.pos.x}'></li>\n                    <li>${tab + tab}y:<input data-type='y' class='js-input input' type='text' value='${ops.options.pos.y}'></li>\n                    <li>${tab + tab}scale:<input data-type='scale' class='js-input input' type='text' value='${ops.options.pos.scale}'></li>\n                    <li>${tab + tab}rotate:<input data-type='rotate' class='js-input input' type='text' value='${ops.options.pos.rotate}'></li>\n                    <li>${tab}}</li>\n                    <li>}</li>`\n            break\n        case 'watermark':\n            html = `<li>image:'${ops.image}'</li>\n                    <li>options:{</li>\n                    <li>${tab}width:<input data-type='width' class='js-input input' type='text' value='${ops.options.width}'></li>\n                    <li>${tab}pos:\n                        <select data-type='pos' class='js-select select'>\n                            <option>rightBottom</option>\n                            <option>rightTop</option>\n                            <option>leftBottom</option>\n                            <option>leftTop</option>\n                        </select>\n                    <li>}</li>`\n            break\n        case 'text':\n            html = `<li>text:<span style=\"font-size:12px;\">''&lt;b&gt;Large/Stroke&lt;/b&gt;Normal/Gradient&lt;s&gt;Small/Shadow&lt;/s&gt;''</span></li>\n                    <li>options:{</li>\n                    <li>${tab}width:<input data-type='width' class='js-input input' type='text' value='${ops.options.width}'></li>\n                    <li>${tab}align:\n                        <select data-type='align' class='js-select select'>\n                            <option>left</option>\n                            <option>center</option>\n                            <option>right</option>\n                        </select>\n                    </li>\n                    <li>${tab}pos:{\n                    <li>${tab + tab}x:<input data-type='x' class='js-input input' type='text' value='${ops.options.pos.x}'></li>\n                    <li>${tab + tab}y:<input data-type='y' class='js-input input' type='text' value='${ops.options.pos.y}'></li>\n                    <li>${tab}}</li>\n                    <li>}</li>`\n            break\n        default:\n    }\n    $params.html(html)\n    $sure.data('ops', JSON.stringify(ops)).data('type', type)\n    $dialog.show()\n}\n\n$(window).on('input', '.js-input', function(){\n    let $this = $(this)\n    let v = $this.val()\n    let type = $this.data('type')\n    let ops = $sure.data('ops')\n    switch (type) {\n        case 'width':\n            ops.options.width = v\n            break\n        case 'x':\n            ops.options.pos.x = v\n            break\n        case 'y':\n            ops.options.pos.y = v\n            break\n        case 'scale':\n            ops.options.pos.scale = v\n            break\n        case 'rotate':\n            ops.options.pos.rotate = v\n            break\n        case 'align':\n            ops.options.align = v\n            break\n        default:\n    }\n    $sure.data('ops', JSON.stringify(ops))\n})\n\n$(window).on('focus', '.js-input', function(){\n    $(this).addClass('focus')\n})\n$(window).on('blur', '.js-input', function(){\n    $(this).removeClass('focus')\n})\n\n$(window).on('change', '.js-select', function(){\n    let ops = $sure.data('ops')\n    let type = $(this).data('type')\n    ops.options[type] = $(this).val()\n    $sure.data('ops', JSON.stringify(ops))\n})\n\n"],"names":["extend","obj1","obj2","type","isType","forin","k","v","vType","i","length","loadImage","image","loaded","error","img","Image","indexOf","crossOrigin","onload","setTimeout","onerror","src","isObject","tar","isObjFunc","isBoolean","isArr","getImage","cbk","console","log","obj","hasOwnProperty","isIos8","UA","window","navigator","userAgent","toLowerCase","IOS","test","IPAD","match","deepCopy","JSON","parse","stringify","name","Object","prototype","toString","call","split","replace","getSize","iw","ih","tagName","naturalWidth","naturalHeight","width","height","offsetWidth","offsetHeight","MCanvas","options","ops","_","backgroundColor","canvas","ctx","queue","fn","success","data","textId","text","bgConfig","_init","document","createElement","getContext","setBgColor","background","bg","push","color","_background","fillStyle","fillRect","_getBgAlign","left","cw","cropScale","rv","Math","abs","iRatio","cRatio","sx","sy","swidth","sheight","dx","dy","dwidth","dheight","top","drawImage","_next","rect","fillColor","strokeColor","strokeWidth","ch","_get","x","y","lineWidth","strokeStyle","beginPath","strokeRect","closePath","_resetCtx","circle","r","arc","PI","fill","stroke","setTransform","watermark","pos","margin","position","scale","rotate","add","def","crop","forEach","_add","_handleOps","warn","cdx","cdy","cdw","cdh","lsx","lsy","lsw","lsh","cratio","ldx","ldy","ldw","ldh","lcvs","lctx","_ratio","lctxScale","spaceX","spaceY","round","shrink","map","translate","ratio","maxLsw","maxLsh","cropx","cropy","cropw","croph","px","py","pr","ps","parseFloat","context","fontFamily","size","defaultStyle","shadow","blur","offsetX","offsetY","option","align","smallStyle","font","lineHeight","normalStyle","largeStyle","parseContext","_parse","max","maxFont","maxFontSize","parseInt","_text","arr","result","value","splitTag","tmp","textArr","style","line","getLineHeight","measureText","fontLength","tcvs","tctx","tdx","tdy","tdw","tdh","_getTextRectHeight","_fillText","originX","originY","lh","vlh","textAlign","textBaseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","gradient","colorStop","x1","y1","x2","y2","grad","createLinearGradient","colorNum","addColorStop","lastLine","lastLineData","par","child","str","draw","_ops","quality","b64","toDataURL","save","shift","restore","clear","clearRect","$sure","$","$params","$dialog","$result","$cancel","$clear","addImageOps","addWmOps","addRectOps","addCircleOps","addTextOps","mc","timer","on","addClass","removeClass","clearTimeout","hide","attr","showDialog","mcDraw","err","tab","html","show","$this","val"],"mappings":"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"}